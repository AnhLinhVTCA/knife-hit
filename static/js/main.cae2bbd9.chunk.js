(this["webpackJsonpnew-knife-hit"]=this["webpackJsonpnew-knife-hit"]||[]).push([[0],{26:function(t,e,n){t.exports=n(54)},28:function(t,e,n){},54:function(t,e,n){"use strict";n.r(e);var a=n(1),i=n.n(a),o=n(4),r=n(2),c=(n(28),n(0)),s=n(17),d=n.n(s),u=function(){},p=function(t){var e=t.update,n=void 0===e?u:e,a=t.detroy;return{update:n,detroy:void 0===a?u:a}},f=function(t,e){var n=t.x,a=t.y,i=e[0],o=e[0]+e[2],r=e[1],c=e[1]+e[3];return!(n<i||n>o||a<r||a>c)},l=n(3),h=function(t,e){var n=[],a=[];return{addSystem:function(i){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i.init&&i.init(t,e),o?a.push(i):n.push(i)},update:function(i){var o,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=Object(l.a)(n);try{for(c.s();!(o=c.n()).done;){var s=o.value;s.update(i,t,e)}}catch(f){c.e(f)}finally{c.f()}if(r){var d,u=Object(l.a)(a);try{for(u.s();!(d=u.n()).done;){var p=d.value;p.update(i,t,e)}}catch(f){u.e(f)}finally{u.f()}}}}},v=function(t){var e=function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,L(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.setCurrentScreen.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,B(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.setCurrentScreen.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=t.worldWidth,o=t.worldHeight,s=t.assets,d=t.canvas,u=t.batch,l=t.viewport,h=t.camera,v=Object(c.e)(d,l),g=s.atlas;window.atlas=g;var m=g.findRegion("gameover",-1),w=o,b=a,y=g.findRegion("restart-btn",-1),x=[a/2-7,2*o/3,14,7],k=new c.a(0,0);return v.addEventListener("touchStart",(function(){k=v.getTouchedWorldCoord(),f(k,x)&&e(),k.x>=0&&k.x<=13&&k.y>=0&&k.y<=6&&n()})),p({update:function(t){u.setProjection(h.combined),u.begin(),m.draw(u,a/2-b/2,o/2-w/2,b,w),y.draw(u,a/2-7,2*o/3,14,7),u.end()},detroy:function(){v.cleanup()}})},g=function(t){var e=t.worldWidth,n=t.worldHeight,a=t.canvas,i=t.batch,o=t.viewport,r=t.camera,s=t.assets,d=Object(c.e)(a,o),u=s.endgame,f=n,l=e;return p({update:function(t){i.setProjection(r.combined),i.begin(),i.draw(u,e/2-l/2,n/2-f/2,l,f),i.end()},detroy:function(){d.cleanup()}})},m=function(){var t;return{init:function(e,n){e.knifeIndex;var a=n.assets.atlas;t=a.findRegion("background",-1)},update:function(e,n,a){var i=a.batch,o=a.worldWidth,r=a.worldheight,c=a.camera;i.setProjection(c.combined),i.begin(),i.setColor(1,1,1,1),t.draw(i,0,0,o,r),i.end()}}},w=function(){var t;return{init:function(e,n){var a=e.knifeIndex,i=n.assets.atlas.findRegions("95852d40-981a-48e5-bf16-1d7246f3963f_scaled");t=i[a]},update:function(e,n,a){var i=n.knifeState,o=a.batch,r=a.camera;o.setProjection(r.combined),o.begin(),t.draw(o,i.position.x-i.width/2,i.position.y-i.height/2,i.width,i.height),o.end()}}},b=function(){var t,e;return{init:function(n,a){n.knifeIndex;var i=a.assets.atlas;t=i.findRegion("Goal",-1),e=i.findRegion("GoalWhite",-1)},update:function(n,a,i){var o=a.goalState,r=a.vibrateGoal,c=a.optionGame,s=a.indexOptionGame,d=a.knifeHit,u=i.batch,p=i.camera;d.length<c[s].countShotting&&(u.setProjection(p.combined),u.begin(),t.draw(u,o.position.x-o.radius/2,o.position.y-o.radius/2,o.radius,o.radius,o.radius/2,o.radius/2,o.angle),r&&(u.setColor(1,1,1,.5),e.draw(u,o.position.x-o.radius/2,o.position.y-o.radius/2,o.radius,o.radius),u.setColor(1,1,1,1)),u.end())}}},y=function(){var t,e;return{init:function(e,n){var a=e.knifeIndex,i=n.assets.atlas.findRegions("95852d40-981a-48e5-bf16-1d7246f3963f_scaled");t=i[a]},update:function(n,a,i){var o=a.totalKnifeState,r=a.optionGame,c=a.indexOptionGame,s=a.knifeHit,d=i.batch,u=i.camera,p=i.worldWidth;d.setProjection(u.combined),d.begin(),e=o.position.y,d.setColor(0,0,0,1);for(var f=0;f<r[c].countShotting-r[c].goalKnife;f++)t.draw(d,o.position.x-1.25,e,2.5,7.5,1.25,3.75,o.angle),e-=p/12;e=o.position.y,d.setColor(1,1,1,1);for(var l=0;l<r[c].countShotting-s.length;l++)t.draw(d,o.position.x-1.25,e,2.5,7.5,1.25,3.75,o.angle),e-=p/12;d.end()}}},x=0,k=Math.PI,S=Math.PI,j=!0,O=0,M=0,I=0,P=function(t){k=t},G=.5,R=function(t,e,n){for(x+=(S+=.1*(k-S))*t;x>=2*Math.PI;)x-=2*Math.PI;for(;x<0;)x+=2*Math.PI;switch(e){case 1:P(n);break;case 2:!function(t){k=-t}(n);break;case 3:!function(t,e){O>=.7?M>=2?I>=1?(O=0,M=0,I=0):(k=0,I+=t):(k=Math.PI,M+=t):(O+=t,k=e)}(t,n);break;case 4:!function(t,e){O>=.7?M>=2?I>=1?(O=0,M=0,I=0):(k=0,I+=t):(k=-Math.PI,M+=t):(O+=t,k=-e)}(t,n);break;case 5:!function(t,e){j?O>=G?M>=1.5?I>=.7?(O=0,M=0,I=0,j=!1,G=1*Math.random()+1):(k=0,I+=t):(k=-Math.PI,M+=t):(O+=t,k=-e):O>=.7?M>=2?I>=1?(O=0,M=0,I=0,j=!0,G=1*Math.random()+1):(k=0,I+=t):(k=Math.PI,M+=t):(O+=t,k=e)}(t,n);break;default:P(n)}return{angle:x,speed:S}},C=function(){var t,e=Math.PI/60,n=new c.a;return{update:function(a,i,o){var r=i.goalState,c=i.indexOptionGame,s=i.knifeHit,d=i.optionGame,u=o.worldWidth;t=R(a,d[c].randomSpin,d[c].speedSpin),r.angle=t.angle;var p,f=Object(l.a)(s);try{for(f.s();!(p=f.n()).done;){var h=p.value;h.rotateAngle+=t.speed*a,n.set(u/6,5.5),n.rotateRad(h.rotateAngle),h.tmp2.set(r.position.x,r.position.y),h.tmp2.addVector(n),n.set(u/2.3,10),n.rotateRad(h.rotateAngle),h.tmp3.set(r.position.x,r.position.y),h.tmp3.addVector(n),n.set(u/2.3,5.5),n.rotateRad(h.rotateAngle+e),h.leftcheck.set(r.position.x,r.position.y),h.leftcheck.addVector(n),n.set(u/2.3,10),n.rotateRad(h.rotateAngle-e-.2),h.rightcheck.set(r.position.x,r.position.y),h.rightcheck.addVector(n)}}catch(v){f.e(v)}finally{f.f()}}}},H=function(){var t;return{init:function(e,n){e.knifeIndex;var a=n.assets.atlas;t=a.findRegions("TN_Piece")},update:function(e,n,a){var i=a.batch,o=a.camera,r=n.goalDrop,c=n.knifeHit,s=n.indexOptionGame,d=n.optionGame,u=n.checkRenderGoalDrop;if(c.length>=d[s].countShotting&&u){i.setProjection(o.combined),i.begin();for(var p=0;p<r.length;p++)t[p].draw(i,r[p].position.x-r[p].radius/2,r[p].position.y-r[p].radius/2,r[p].radius,r[p].radius);i.end()}}}},D=function(t){var e=function(){var e=Object(r.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,L(t,n);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.setCurrentScreen.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{update:function(t,n,a){a.worldWidth;var i=n.goalDrop,o=n.knifeHit,r=n.optionGame,c=n.indexOptionGame;if(o.length>=r[c].countShotting){i[0].position.x-=t*i[0].speed,i[0].position.y+=t*i[0].speed,i[1].position.x-=t*i[1].speed,i[1].position.y-=t*i[1].speed,i[2].position.x+=t*i[2].speed,i[2].position.y+=t*i[2].speed,i[3].position.x+=t*i[3].speed,i[3].position.y-=t*i[3].speed;var s,d=Object(l.a)(i);try{for(d.s();!(s=d.n()).done;){var u=s.value;u.opacity>0&&(u.opacity-=.09)}}catch(p){d.e(p)}finally{d.f()}n.checkRenderGoalDrop=!0,i[0].position.x<-10&&e(c+1)}}}},W=function(){var t,e=!1;return{update:function(n,a,i){var o=i.inputHandler,r=i.worldWidth,s=i.worldHeight,d=a.knifeState,u=a.bullets,p=a.knifeHit;if(o.addEventListener("touchStart",(function(){t||a.checkKnifeDrop||a.checkRenderGoalDrop||(t=!0)})),t&&(d.position.y-=n*d.speedY),d.position.y<=s/2.5){var f,h=Object(l.a)(p);try{for(h.s();!(f=h.n()).done;){var v=f.value;if(d.position.x+d.width/2>=v.leftcheck.x&&d.position.x-d.width/2<=v.rightcheck.x&&v.leftcheck.y>=s/3){e=!0,a.checkKnifeDrop=!0;break}}}catch(m){h.e(m)}finally{h.f()}if(!e){p.push({tmp2:new c.a(0,0),tmp3:new c.a(0,0),rightcheck:new c.a(0,0),leftcheck:new c.a(0,0),rotateAngle:89.2});for(var g=0;g<15;g++)u.push({position:new c.a(r/2,s/5*2),velocity:new c.a(Math.random()*r-r/2,Math.random()*r),radius:1*Math.random(),speed:3,lifeSpan:0,expire:Math.random()*(.3-.1)+.1});a.vibrateGoal=!0,a.score+=1}d.position.y=s,t=!1}d.position.y>4*s/5&&!t&&(d.position.y-=n*d.speedY,d.position.y<=4*s/5&&(d.position.y=4*s/5))}}},K=function(){var t;return{init:function(e,n){e.knifeIndex;var a=n.assets.atlas;t=a.findRegion("GoalWhite",-1)},update:function(e,n,a){var i=n.bullets,o=a.batch,r=a.camera;o.setProjection(r.combined),o.begin();var c,s=Object(l.a)(i);try{for(s.s();!(c=s.n()).done;){var d=c.value;t.draw(o,d.position.x,d.position.y,d.radius,d.radius,0,0,0)}}catch(u){s.e(u)}finally{s.f()}o.end()}}},_=function(){var t=.034,e=0;return{update:function(n,a,i){i.inputHandler;var o=a.goalState;a.vibrateGoal&&(0===e&&(e=o.position.y),t<=0?(o.position.y+=100*n,o.position.y>=e&&(o.position.y=e,t=.034,e=0,a.vibrateGoal=!1)):(t-=n,o.position.y-=100*n))}}},T=function(){var t=new c.a;return{update:function(e,n){for(var a=n.bullets,i=a.length-1;i>=0;i--)t.setVector(a[i].velocity).scale(e*a[i].speed),a[i].position.addVector(t),a[i].lifeSpan+=e,a[i].lifeSpan>=a[i].expire&&a.splice(i,1)}}},A=function(){var t,e=function(t,e,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,d=n.distance(a),u=a.subVector(n).angle();t.setColor(o,r,c,s),e.draw(t,n.x,n.y,i,d,0,0,u-Math.PI/2),t.setColor(1,1,1,1)};return{init:function(e,n){var a=e.knifeIndex,i=n.assets.atlas.findRegions("95852d40-981a-48e5-bf16-1d7246f3963f_scaled");t=i[a]},update:function(n,a,i){var o=a.knifeHit,r=a.optionGame,c=a.indexOptionGame,s=i.batch,d=i.camera;if(o.length<r[c].countShotting){s.setProjection(d.combined),s.begin();var u,p=Object(l.a)(o);try{for(p.s();!(u=p.n()).done;){var f=u.value;e(s,t,f.tmp2,f.tmp3,4)}}catch(h){p.e(h)}finally{p.f()}s.end()}}}},V=function(){var t=new c.a;return{update:function(e,n,a){var i=a.worldWidth,o=a.worldHeight,r=n.checkKnifeDrop,c=n.knifeDrop;r&&(t.set(c.position.x,c.position.y),c.position.y+=e*o*(c.speed/o),c.position.x-=e*(i/2),c.rotate-=4*Math.PI*e,c.position.y>o&&(c.position.y=t.y,c.position.x=t.x,t.set(0,0),n.checkKnifeDrop=!1,n.gameOver=!0))}}},E=function(){var t;return{init:function(e,n){var a=e.knifeIndex,i=n.assets.atlas.findRegions("95852d40-981a-48e5-bf16-1d7246f3963f_scaled");t=i[a]},update:function(e,n,a){var i=n.knifeDrop,o=n.knifeState,r=n.checkKnifeDrop,c=a.batch,s=a.camera;r&&(c.setProjection(s.combined),c.begin(),t.draw(c,i.position.x,i.position.y,o.width,o.height,o.width/2,o.height/2,i.rotate),c.end())}}},L=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.knifeIndex,a=t.worldWidth,o=t.worldHeight,s=t.canvas,d=t.gl,u=t.batch,p=t.camera,f=t.whiteTex,l=t.viewport,x=t.assets,k=Object(c.e)(s,l),S={knifeIndex:n,indexOptionGame:e,win:!1,gameOver:!1,knifeHit:[],bullets:[],score:0,vibrateGoal:!1,checkKnifeDrop:!1,checkRenderGoalDrop:!1,totalKnifeState:{position:new c.a(a/10,3*o/4),angle:5.5},knifeState:{position:new c.a(a/2,4*o/5),speedY:2.5*o,width:5,height:15},goalState:{position:new c.a(a/2,o/3.5),radius:30,angle:0},knifeDrop:{position:new c.a(a/2,o/4.7*2),rotate:0,speed:100},goalDrop:[{position:new c.a(a/2,o/3.5),radius:30,opacity:1,speed:2*a},{position:new c.a(a/2,o/3.5),radius:30,opacity:1,speed:2*a},{position:new c.a(a/2,o/3.5),radius:30,opacity:1,speed:2*a},{position:new c.a(a/2,o/3.5),radius:30,opacity:1,speed:2*a}],optionGame:[{countShotting:5,goalKnife:0,apple:0,speedSpin:Math.PI,randomSpin:1},{countShotting:7,goalKnife:1,apple:0,speedSpin:Math.PI,randomSpin:Math.floor(1*Math.random()+1)},{countShotting:10,goalKnife:Math.floor(2*Math.random()+2),apple:0,speedSpin:Math.floor(3*Math.random()+1)*Math.PI,randomSpin:Math.floor(4*Math.random()+2)},{countShotting:10,goalKnife:Math.floor(2*Math.random()+2),apple:0,speedSpin:Math.floor(3*Math.random()+1)*Math.PI,randomSpin:Math.floor(4*Math.random()+2)}]},j={worldWidth:a,worldHeight:o,canvas:s,gl:d,batch:u,camera:p,viewport:l,inputHandler:k,whiteTex:f,assets:x},O=h(S,j);if(e<4){O.addSystem(C(),!0),O.addSystem(W(),!0),O.addSystem(T(),!0),O.addSystem(_(),!0),O.addSystem(V(),!0),O.addSystem(D(t),!0),O.addSystem(m()),O.addSystem(w()),O.addSystem(y()),O.addSystem(A()),O.addSystem(b()),O.addSystem(K()),O.addSystem(E()),O.addSystem(H());for(var M=0;M<S.optionGame[e].goalKnife;M++)S.knifeHit.push({tmp2:new c.a(0,0),tmp3:new c.a(0,0),rightcheck:new c.a(0,0),leftcheck:new c.a(0,0),rotateAngle:89.2})}var I=function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,v(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.setCurrentScreen.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,g(t);case 3:e.t1=e.sent,e.t0.setCurrentScreen.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=0,R=function(t){4===e?(G+=t,O.update(t),G>=.5&&P()):S.gameOver?I():(S.stateTime+=t,O.update(t))};return{update:R,detroy:function(){k.cleanup()}}},B=function(t){var e=function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,L(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.setCurrentScreen.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=t.worldWidth,a=t.worldHeight,o=t.assets,s=t.canvas,d=t.batch,u=t.viewport,l=t.camera,h=Object(c.e)(s,u),v=o.atlas;window.atlas=v;var g,m,w,b,y=v.findRegion("dashboard",-1),x=a,k=n,S=v.findRegion("select-knife-btn",-1),j=v.findRegion("start-btn",-1),O=[n/2-3,5*a/6,6,5],M=[n/2-7,2*a/3,14,7],I=v.findRegions("95852d40-981a-48e5-bf16-1d7246f3963f_scaled"),P=0,G=n/5,R=n/6,C=!1,H=new c.a(0,0);return h.addEventListener("touchStart",(function(){if(H=h.getTouchedWorldCoord(),f(H,O)&&(C=!C),f(H,M)&&!1===C&&e(),C){w=n/5+n/10,g=n/5+n/10+n/14,b=n/6+n/10,m=n/6+n/10+n/14;for(var i=0;i<I.length;i++){if(i<4&&H.x>=w&&H.x<=g&&H.y>=a/2-a/8&&H.y<=a/2-a/8+a/8){t.knifeIndex=P=i,C=!1;break}if(i<5&&H.x>=b&&H.x<=m&&H.y>=a/2+a/18&&H.y<=a/2+a/18+a/8){t.knifeIndex=P=i+4,C=!1;break}g+=n/10,w+=n/10,m+=n/10,b+=n/10}}})),p({update:function(t){if(d.setProjection(l.combined),d.begin(),y.draw(d,n/2-k/2,a/2-x/2,k,x),S.draw(d,n/2-3,5*a/6,6,5),C){G=n/5,R=n/6;for(var e=0;e<I.length;e++){var i=I[e];e<4?i.draw(d,G+=n/10,a/2-a/8,n/14,a/8):i.draw(d,R+=n/10,a/2+a/18,n/14,a/8)}}else j.draw(d,n/2-7,2*a/3,14,7),I[P].draw(d,n/2-1.5,a/2-2.5,n/14,a/8);d.end()},detroy:function(){h.cleanup()}})};(function(){var t=Object(r.a)(i.a.mark((function t(){var e,n,a,r,s,u,p,f,l,h,v,g,m,w,b,y,x,k,S,j,O,M,I;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("main"),n=document.getElementById("info"),a=47,r=100,s=Object(c.d)(e,a,r),u=s.getContext(),p=s.getCamera(),f=Object(c.b)(u),l=d()(u),h={knifeIndex:0,worldWidth:a,worldHeight:r,canvas:e,gl:u,batch:f,camera:p,viewport:s,whiteTex:l,setCurrentScreen:function(t){h.currentScreen&&h.currentScreen.detroy(),h.currentScreen=t}},t.next=11,Object(c.h)(u,"./assets/loading.jpg");case 11:return v=t.sent,m=(g=r)*v.width/v.height,w=0,b=function(){f.setProjection(p.combined),f.begin(),f.setColor(1,1,1,1),Object(c.f)(f,v,a/2-m/2,0,m,g),Object(c.f)(f,l,a/2-a/2.9,2.5*r/4-r/50,a/1.45,r/25),f.setColor(0,0,0,1),Object(c.f)(f,l,a/2-a/3,2.5*r/4-r/60,a/1.5,r/30),f.setColor(1,1,1,1);var t=w/1;Object(c.f)(f,l,a/2-a/3.1,2.5*r/4-r/80,a/1.55*t,r/40),f.end()},y=function(t){return t.then((function(t){return b(),w++,t}))},t.next=19,Promise.all([y(Object(c.g)(u,"./assets/asset.atlas")),y(Object(c.h)(u,"./assets/30415188_209078973189365_5726395929146163200_n.jpg"))]);case 19:return x=t.sent,k=Object(o.a)(x,2),S=k[0],j=k[1],O={atlas:S,endgame:j},h.assets=O,t.t0=h,t.next=28,B(h);case 28:t.t1=t.sent,t.t0.setCurrentScreen.call(t.t0,t.t1),u.clearColor(0,0,0,1),M=function(t){u.clear(u.COLOR_BUFFER_BIT),h.currentScreen&&h.currentScreen.update(t)},I=Object(c.c)(M),setInterval((function(){n.innerHTML="FPS:".concat(I.getFps())}),1e3);case 34:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}},[[26,1,2]]]);
//# sourceMappingURL=main.cae2bbd9.chunk.js.map